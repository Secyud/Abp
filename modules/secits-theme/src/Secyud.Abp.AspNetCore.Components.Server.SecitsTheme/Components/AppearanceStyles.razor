@using Microsoft.Extensions.Options
@using Secyud.Abp.AspNetCore.Styles
@using Secyud.Secits.Blazor
@using Secyud.Secits.Blazor.Options
@using Volo.Abp.Localization
@inject ISecitsStyleProvider SecitsStyleProvider
@inject IOptions<SecitsThemeOptions> ThemeOptions
@inject IOptions<SecitsStylesOptions> StylesOptions

@foreach (var path in _styles)
{
    <link href="@path.Path" id="@path.Id" type="text/css" rel="stylesheet" theme="secits"/>
}

@code {

    private readonly List<SecitsStyleFile> _styles = [];

    protected override async Task OnInitializedAsync()
    {
        var selectedStyle = await SecitsStyleProvider.GetCurrentStyleAsync();
        var option = new SecitsThemeParam();
        ThemeOptions.Value.Styles.GetValueOrDefault(selectedStyle)?.MapTo(option);
        option.IsRtl = CultureHelper.IsRtl;
        _styles.Clear();
        _styles.AddRange(StylesOptions.Value.Get(option));
    }

}